---js
{
  pagination: {
    data: "manualNodes",
    size: 1,
    alias: "node",
    before: items => items.filter(i => i.type === "page")
  },
  // uncomment to generate page files in "temp"
  // permalinkBypassOutputDir: true,
  // permalink: "temp/partials/{{ node.manual }}/{{ node.group }}/{{ node.node_id }}.liquid",
  // uncomment to stop generating page files in "temp"
  permalink: false
}
---
{%- assign nodes = manualNodes | where: "manual", node.manual -%}
{%- assign manual = manuals | where: "slug", node.manual | first -%}

{%- comment -%} Per-page visual offset for Bootstrap heading classes {%- endcomment -%}
{%- assign visual_offset = 0 -%}
{%- case node.level -%}
  {%- when 0 -%}{% assign visual_offset = 0 %}
  {%- when 1 -%}{% assign visual_offset = 1 %}
  {%- when 2 -%}{% assign visual_offset = 2 %}
  {%- else -%}{% assign visual_offset = 3 %}
{%- endcase -%}

<h1 id="{{ node.node_id }}-title">{{ node.title }}</h1>

{% comment %} Top-level child headings under this page {% endcomment %}
{%- assign firstLevel = nodes
  | where: "type", "heading"
  | where: "parent_node", node.node_id
  | sort: "node_id" -%}

{%- for h in firstLevel -%}
  {% render "partials/_page-generator-helper.liquid",
      section: h,
      base_level: node.level,
      visual_offset: visual_offset,
      nodes: nodes,
      manual: manual
  %}
{%- endfor -%}